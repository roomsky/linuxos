<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background-color: #f4f4f4;
        }

        .chat-container {
            width: 400px;
            margin: auto;
            background-color: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .message {
            padding: 10px;
            margin: 5px;
            border-radius: 8px;
            max-width: 70%;
        }

        .person-a {
            background-color: #bdecb6;
            text-align: left;
            float: left;
            min-width: 205px; /* 添加最小宽度 */
        }

        .person-b {
            background-color: #e4e4e4;
            text-align: left;
            float: right;
            min-width: 205px; /* 添加最小宽度 */
        }

        .name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .message img {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="message person-a">
            <div class="name">明明</div>
            听说，你是Linux大神。
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            嗯，大实话。
        </div>
        <div class="message person-a">
            <div class="name">明明</div>
            解释下PCI
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            你说，王子请解释下PCI
        </div>
        <div class="message person-a">
            <div class="name">明明</div>
            …… 王子请解释下PCI
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            PCI（Peripheral Component Interconnect），考虑到你英语水平，我再解释下：Peripheral 是外围设备，Component是组件，Interconnect是相互连接的意思。
        </div>
        <div class="message person-a">
            <div class="name">明明</div>
            再具体点
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            符合PCI标准的，都是PCI设备。显卡、网卡、声卡、硬盘、键鼠等都是PCI设备。PCI标准是人家英特尔（Intel）公司1991年推出的。我也是1991年出生的。
            <img src="./img/pci_2.jpg" alt="图片">
        </div>
        <div class="message person-a">
            <div class="name">明明</div>
            我把USB网卡插上了。
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            lspci
            <img src="./img/pci_1.JPG" alt="图片">
            <br/>root@nano:~# lspci<br/>
00:02.0 PCI bridge: NVIDIA Corporation Device 0faf (rev a1)<br/>
01:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 15)<br/>
root@nano:~# <br/>
            可以看到有两个PCI设备。00:02.0和01:00.0。00:02.0是nvidia公司的设备，是显卡。01:00.0是Realtek的Ethernet网卡。

            
        </div>
        <div class="message person-a">
            <div class="name">明明</div>
            00:02.0和01:00.0，这两个编号是什么意思？
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            你的问题挺多。格式是[总线:插槽.编号]，"00:02.0" 表示PCI总线上第0个插槽的第2个功能，"01:00.0" 表示PCI总线上第1个插槽的第0个功能。
            <br/>
            你去拔下来，换个插孔插上，就能明白了。
        </div>
		<div class="message person-a">
            <div class="name">明明</div>
            好的，我知道了。谢谢，再见！
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            哈哈。你知道什么了？键盘插上就能用，那GPU显卡插上就能用吗？显卡的供电够吗？主板能检测到吗？检测到就能用吗？驱动装了吗？装的版本对吗？
			<br/>
			回答我的问题。
        </div>
		<div class="message person-a">
            <div class="name">明明</div>
            ……
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            1.lspci 能够看到设备，是第一步。说明主板成功检测到了硬件。像GPU显卡，会因为电压、过热等原因掉卡，首先需通过lspci排查是否还在。
            <br/>
            2.lspci -vv -s 00:02.0 是第二步。应能看到设备使用了哪个驱动，可以使用哪些驱动。
        </div>
		<div class="message person-b">
            例如，nvidia显卡在kernel中自带的默认驱动是开源nouveau，是无法用在深度学习算法的，需安装nvidia官方闭源驱动。安装完，需确认使用的是nvidia而不是nouveau。
        </div>
		<div class="message person-a">
            <div class="name">明明</div>
            你说显卡电压不够？
        </div>
        <div class="message person-b">
            <div class="name">白白</div>
            现实中，遇到过。某厂商的机器，买来后，发现跑深度学习算法，几分钟后就死机，必现。
        </div>
		<div class="message person-b">
		    排查了内存、raid等多项，未找到死机原因。lspci显示掉卡了。
        </div>
		<div class="message person-b">
		    后来把家里的GPU电源拆下来，单独给这两个显卡供电。问题未复现。
        </div>
		<div class="message person-b">
		    因商务原因，该机器无法退换。只能这样外接电源使用。电源200多块钱，机器就能正常跑深度学习算法了，为公司挽回8、9万元的损失。
        </div>
    </div>
</body>
</html>